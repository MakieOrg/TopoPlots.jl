<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General TopoPlots · TopoPlots.jl</title><meta name="title" content="General TopoPlots · TopoPlots.jl"/><meta property="og:title" content="General TopoPlots · TopoPlots.jl"/><meta property="twitter:title" content="General TopoPlots · TopoPlots.jl"/><meta name="description" content="Documentation for TopoPlots.jl."/><meta property="og:description" content="Documentation for TopoPlots.jl."/><meta property="twitter:description" content="Documentation for TopoPlots.jl."/><meta property="og:url" content="https://MakieOrg.github.io/TopoPlots.jl/general/"/><meta property="twitter:url" content="https://MakieOrg.github.io/TopoPlots.jl/general/"/><link rel="canonical" href="https://MakieOrg.github.io/TopoPlots.jl/general/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TopoPlots.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>General TopoPlots</a><ul class="internal"><li><a class="tocitem" href="#Interpolation"><span>Interpolation</span></a></li><li><a class="tocitem" href="#Extrapolation"><span>Extrapolation</span></a></li><li><a class="tocitem" href="#Interactive-exploration"><span>Interactive exploration</span></a></li><li><a class="tocitem" href="#Different-geometry"><span>Different geometry</span></a></li></ul></li><li><a class="tocitem" href="../eeg/">EEG</a></li><li><a class="tocitem" href="../functions/">Function reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>General TopoPlots</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General TopoPlots</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MakieOrg/TopoPlots.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MakieOrg/TopoPlots.jl/blob/master/docs/src/general.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Recipe-for-General-TopoPlots"><a class="docs-heading-anchor" href="#Recipe-for-General-TopoPlots">Recipe for General TopoPlots</a><a id="Recipe-for-General-TopoPlots-1"></a><a class="docs-heading-anchor-permalink" href="#Recipe-for-General-TopoPlots" title="Permalink"></a></h1><p>At the core of TopoPlots.jl is the <code>topoplot</code> recipe, which takes an array of measurements and an array of positions, which then creates a heatmap like plot which interpolates between the measurements from the positions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.topoplot" href="#TopoPlots.topoplot"><code>TopoPlots.topoplot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">topoplot(data::Vector{&lt;:Real}, positions::Vector{&lt;: Point2})</code></pre><p>Creates an irregular interpolation for each <code>data[i]</code> point at <code>positions[i]</code>.</p><p><strong>Attributes</strong></p><ul><li><p><code>colormap = Reverse(:RdBu)</code></p></li><li><p><code>colorrange = automatic</code></p></li><li><p><code>labels::Vector{&lt;:String}</code> = nothing: names for each data point</p></li><li><p><code>interpolation::Interpolator = CloughTocher()</code>: Applicable interpolators are TopoPlots.CloughTocher, TopoPlots.DelaunayMesh, TopoPlots.NullInterpolator, TopoPlots.ScatteredInterpolationMethod, TopoPlots.SplineInterpolator</p></li><li><p><code>extrapolation = GeomExtrapolation()</code>: Extrapolation method for adding additional points to get less border artifacts</p></li><li><p><code>bounding_geometry = Circle</code>: A geometry that defines what to mask and the x/y extend of the interpolation. E.g. <code>Rect(0, 0, 100, 200)</code>, will create a <code>heatmap(0..100, 0..200, ...)</code>. By default, a circle enclosing the <code>positions</code> points will be used.</p></li><li><p><code>enlarge</code> = 1.2<code>, enlarges the area that is being drawn. E.g., if</code>bounding_geometry<code>is</code>Circle`, a circle will be fitted to the points and the interpolation area that gets drawn will be 1.2x that bounding circle.</p></li><li><p><code>interp_resolution = (512, 512)</code>: resolution of the interpolation</p></li><li><p><code>label_text = false</code>:</p><ul><li>true: add text plot for each position from <code>labels</code></li><li>NamedTuple: Attributes get passed to the Makie.text! call.</li></ul></li><li><p><code>label_scatter = false</code>:</p><ul><li>true: add point for each position with default attributes</li><li>NamedTuple: Attributes get passed to the Makie.scatter! call.</li></ul></li><li><p><code>markersize = 5</code>: size of the points defined by positions, shortcut for label_scatter=(markersize=5,)</p></li><li><p><code>contours = false</code>:</p><ul><li>true: add scatter point for each position</li><li>NamedTuple: Attributes get passed to the Makie.contour! call.</li></ul></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using TopoPlots, CairoMakie
topoplot(rand(10), rand(Point2f, 10); contours=(color=:red, linewidth=2))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/core-recipe.jl#L20-L53">source</a></section></article><h2 id="Interpolation"><a class="docs-heading-anchor" href="#Interpolation">Interpolation</a><a id="Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolation" title="Permalink"></a></h2><p>The recipe supports different interpolation methods, namely:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.DelaunayMesh" href="#TopoPlots.DelaunayMesh"><code>TopoPlots.DelaunayMesh</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DelaunayMesh()</code></pre><p>Creates a delaunay triangulation of the points and linearly interpolates between the vertices of the triangle. Really fast interpolation that happens on the GPU (for GLMakie), so optimal for exploring larger timeseries.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><code>DelaunayMesh</code> won&#39;t allow you to add a contour plot to the topoplot.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/interpolators.jl#L78-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.CloughTocher" href="#TopoPlots.CloughTocher"><code>TopoPlots.CloughTocher</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CloughTocher(fill_value=NaN, tol=1e-6, maxiter=400, rescale=false)</code></pre><p>Piecewise cubic, C1 smooth, curvature-minimizing interpolant in 2D. Find more detailed docs in CloughTocher2DInterpolator.jl.</p><p>This is the default interpolator in MNE-Python</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/interpolators.jl#L9-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.SplineInterpolator" href="#TopoPlots.SplineInterpolator"><code>TopoPlots.SplineInterpolator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SplineInterpolator(;kx=2, ky=2, smoothing=0.5)</code></pre><p>Uses <a href="https://github.com/kbarbary/Dierckx.jl#2-d-splines">Dierckx.Spline2D</a> for interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/interpolators.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.ScatteredInterpolationMethod" href="#TopoPlots.ScatteredInterpolationMethod"><code>TopoPlots.ScatteredInterpolationMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ScatteredInterpolationMethod(InterpolationMethod)

Container to specify a `InterpolationMethod` from ScatteredInterpolation.
E.g. ScatteredInterpolationMethod(Shepard(P=4))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/interpolators.jl#L102-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.NullInterpolator" href="#TopoPlots.NullInterpolator"><code>TopoPlots.NullInterpolator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NullInterpolator()</code></pre><p>Interpolator that returns &quot;0&quot;, which is useful to display only the electrode locations + labels</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/interpolators.jl#L132-L136">source</a></section></article><p>One can define your own interpolation by subtyping:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.Interpolator" href="#TopoPlots.Interpolator"><code>TopoPlots.Interpolator</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Interface for all types &lt;: Interpolator:</p><pre><code class="nohighlight hljs">interpolator = Interpolator(; kw_specific_to_interpolator)
interpolator(xrange::LinRange, yrange::LinRange, positions::Vector{Point2}, data::Vector{&lt;: Real})::Matrix{&lt;: Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/interpolators.jl#L1-L6">source</a></section></article><p>The different interpolation schemes look quite different:</p><pre><code class="language-julia hljs">using TopoPlots, CairoMakie, ScatteredInterpolation

data, positions = TopoPlots.example_data()

f = Figure(resolution=(1000, 1000))

interpolators = [
    DelaunayMesh() CloughTocher();
    SplineInterpolator() NullInterpolator();
    ScatteredInterpolationMethod(ThinPlate()) ScatteredInterpolationMethod(Shepard(3))]

data_slice = data[:, 360, 1]

for idx in CartesianIndices(interpolators)
    interpolation = interpolators[idx]

    # precompile to get accurate measurements
    TopoPlots.topoplot(
        data_slice, positions;
        contours=true, interpolation=interpolation,
        labels = string.(1:length(positions)), colorrange=(-1, 1),
        label_scatter=(markersize=10,),
        axis=(type=Axis, title=&quot;...&quot;, aspect=DataAspect(),))

    # measure time, to give an idea of what speed to expect from the different interpolators
    t = @elapsed ax, pl = TopoPlots.topoplot(
        f[Tuple(idx)...], data_slice, positions;
        contours=true,
        interpolation=interpolation,
        labels = string.(1:length(positions)), colorrange=(-1, 1),
        label_scatter=(markersize=10,),
        axis=(type=Axis, title=&quot;$(typeof(interpolation))()&quot;,aspect=DataAspect(),))

   ax.title = (&quot;$(typeof(interpolation))() - $(round(t, digits=2))s&quot;)
end
f</code></pre><img src="9522fa79.png" alt="Example block output"/><h2 id="Extrapolation"><a class="docs-heading-anchor" href="#Extrapolation">Extrapolation</a><a id="Extrapolation-1"></a><a class="docs-heading-anchor-permalink" href="#Extrapolation" title="Permalink"></a></h2><p>There are currently just two extrapolations: None (<code>NullExtrapolation()</code>) and a geometry based one:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TopoPlots.GeomExtrapolation" href="#TopoPlots.GeomExtrapolation"><code>TopoPlots.GeomExtrapolation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GeomExtrapolation(
    method = Shepard(), # extrapolation method
    geometry = Rect, # the geometry to fit around the points
    enlarge = 3.0 # the amount to grow the bounding geometry for adding the extra points
)</code></pre><p>Takes positions and data, and returns points and additional datapoints on an enlarged bounding geometry:</p><pre><code class="language-julia hljs">extra = GeomExtrapolation()
extra_positions, extra_data, bounding_geometry, bounding_geometry_enlarged = extra(positions, data)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/TopoPlots.jl/blob/5efe0296885b30971d5dce20b816406a9bbad06d/src/extrapolation.jl#L36-L48">source</a></section></article><p>The extrapolations in action:</p><pre><code class="language-julia hljs">data, positions = TopoPlots.example_data()
titles = [&quot;No Extrapolation&quot;, &quot;Rect&quot;, &quot;Circle&quot;]
data_slice = data[:, 340, 1]
f = Figure(resolution=(900, 300))
for (i, extra) in enumerate([NullExtrapolation(), GeomExtrapolation(enlarge=3.0), GeomExtrapolation(enlarge=3.0, geometry=Circle)])
    pos_extra, data_extra, rect_extended, rect = extra(positions, data_slice)
    geom = extra isa NullExtrapolation ? Rect : extra.geometry
    # Note, that enlarge doesn&#39;t match (the default), the additional points won&#39;t be seen and masked by `bounding_geometry` and `enlarge`.
    enlarge = extra isa NullExtrapolation ? 1.0 : extra.enlarge
    ax, p = topoplot(f[1, i], data_slice, positions; extrapolation=extra, bounding_geometry=geom, enlarge=enlarge, axis=(aspect=DataAspect(), title=titles[i]))
    scatter!(ax, pos_extra, color=data_extra, markersize=10, strokewidth=0.5, strokecolor=:white, colormap = p.colormap, colorrange = p.colorrange)
    lines!(ax, rect_extended, color=:black, linewidth=4)
    lines!(ax, rect, color=:red, linewidth=1)
end
resize_to_layout!(f)
f</code></pre><img src="038b4b64.png" alt="Example block output"/><h2 id="Interactive-exploration"><a class="docs-heading-anchor" href="#Interactive-exploration">Interactive exploration</a><a id="Interactive-exploration-1"></a><a class="docs-heading-anchor-permalink" href="#Interactive-exploration" title="Permalink"></a></h2><p><code>DelaunayMesh</code> is best suited for interactive data exploration, which can be done quite easily with Makie&#39;s native UI and observable framework:</p><pre><code class="language-julia hljs">f = Figure(resolution=(1000, 1000))
s = Slider(f[:, 1], range=1:size(data, 2), startvalue=351)
data_obs = map(s.value) do idx
    data[:, idx, 1]
end
TopoPlots.topoplot(
    f[2, 1],
    data_obs, positions,
    interpolation=DelaunayMesh(),
    labels = string.(1:length(positions)),
    colorrange=(-1, 1),
    colormap=:viridis,
    axis=(title=&quot;delaunay mesh&quot;,aspect=DataAspect(),))
f</code></pre><img src="1615c590.png" alt="Example block output"/><h2 id="Different-geometry"><a class="docs-heading-anchor" href="#Different-geometry">Different geometry</a><a id="Different-geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Different-geometry" title="Permalink"></a></h2><p>The bounding geometry pads the input data with more points in the form of the geometry. So e.g. for maps, one can use <code>Rect</code> as the bounding geometry:</p><pre><code class="language-julia hljs">TopoPlots.topoplot(
    rand(10), rand(Point2f, 10),
    axis=(; aspect=DataAspect()),
    colorrange=(-1, 1),
    bounding_geometry = Rect,
    label_scatter=(; strokewidth=2),
    contours=(linewidth=2, color=:white))</code></pre><img src="8307de79.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../eeg/">EEG »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 24 November 2023 21:42">Friday 24 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
